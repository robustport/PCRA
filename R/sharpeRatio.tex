% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={sharpeRatio.R},
  pdfauthor={marti},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{sharpeRatio.R}
\author{marti}
\date{2022-05-11}

\begin{document}
\maketitle

calculate a traditional or modified Sharpe Ratio of Return over StdDev
or VaR or ES, accompanied with bootstrap of standard error.

A modified version of sharpeRatio that compatible with
table.Peroformance

The Sharpe ratio is simply the return per unit of risk (represented by
variability). In the classic case, the unit of risk is the standard
deviation of the returns.

\deqn{\frac{\overline{(R_{a}-R_{f})}}{\sqrt{\sigma_{(R_{a}-R_{f})}}}}

William Sharpe now recommends \code{\link{InformationRatio}}
preferentially to the original Sharpe Ratio.

The higher the Sharpe ratio, the better the combined performance of
``risk'' and return.

As noted, the traditional Sharpe Ratio is a risk-adjusted measure of
return that uses standard deviation to represent risk.

A number of papers now recommend using a ``modified Sharpe'' ratio using
a Modified Cornish-Fisher VaR or CVaR/Expected Shortfall as the measure
of Risk.

We have recently extended this concept to create multivariate modified
Sharpe-like Ratios for standard deviation, Gaussian VaR, modified VaR,
Gaussian Expected Shortfall, and modified Expected Shortfall. See
\code{\link{VaR}} and \code{\link{ES}}. You can pass additional
arguments to \code{\link{VaR}} and \code{\link{ES}} via \dots{} The most
important is probably the `method' argument/

This function returns a traditional or modified Sharpe ratio for the
same periodicity of the data being input (e.g., monthly data
-\textgreater{} monthly SR)

@aliases sharpeRatio.modified sharpeRatio @param R an xts, vector,
matrix, data frame, timeSeries or zoo object of asset returns @param Rf
risk free rate, in same period as your returns @param p confidence level
for calculation, default p=.95 @param methods one of ``StdDev'' or
``VaR'' or ``ES'' to use as the denominator @param weights portfolio
weighting vector, default NULL, see Details in \code{\link{VaR}} @param
annualize if TRUE, annualize the measure, default FALSE @param \dots any
other passthru parameters to the VaR or ES functions @author Brian G.
Peterson, Kirk Li @seealso \code{\link{sharpeRatio.annualized}} \cr
\code{\link{InformationRatio}} \cr \code{\link{TrackingError}} \cr
\code{\link{ActivePremium}} \cr \code{\link{SortinoRatio}} \cr
\code{\link{VaR}} \cr \code{\link{ES}} \cr @references Sharpe, W.F. The
Sharpe Ratio,\emph{Journal of Portfolio
Management},Fall 1994, 49-58.

Laurent Favre and Jose-Antonio Galeano. Mean-Modified Value-at-Risk
Optimization with Hedge Funds. Journal of Alternative Investment, Fall
2002, v 5. @keywords ts multivariate distribution models @examples

data(managers) sharpeRatio(managers{[},1,drop=FALSE{]}, Rf=.035/12,
method=``StdDev'') sharpeRatio(managers{[},1,drop=FALSE{]}, Rf =
managers{[},10,drop=FALSE{]}, method=``StdDev'')
sharpeRatio(managers{[},1:6{]}, Rf=.035/12, method=``StdDev'')
sharpeRatio(managers{[},1:6{]}, Rf = managers{[},10,drop=FALSE{]},
method=``StdDev'')

data(edhec) sharpeRatio(edhec{[}, 6, drop = FALSE{]}, method=``VaR'')
sharpeRatio(edhec{[}, 6, drop = FALSE{]}, Rf = .04/12, FUN=``VaR'')
sharpeRatio(edhec{[}, 6, drop = FALSE{]}, Rf = .04/12, FUN=``VaR'' ,
method=``gaussian'') sharpeRatio(edhec{[}, 6, drop = FALSE{]},
method=``ES'')

\hypertarget{and-all-the-methods}{%
\section{and all the methods}\label{and-all-the-methods}}

sharpeRatio(managers{[},1:9{]}, Rf = managers{[},10,drop=FALSE{]})
sharpeRatio(edhec,Rf = .04/12)

\hypertarget{bootstrap-sd}{%
\section{bootstrap sd}\label{bootstrap-sd}}

\hypertarget{sharperatioedhec-6-drop-false-rf-.0412-methodvar-bootsdtrue}{%
\section{sharpeRatio(edhec{[}, 6, drop = FALSE{]}, Rf = .04/12,
method=``VaR'',
bootsd=TRUE)}\label{sharperatioedhec-6-drop-false-rf-.0412-methodvar-bootsdtrue}}

@export @rdname sharpeRatio

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sharpeRatio }\OtherTok{\textless{}{-}}
\ControlFlowTok{function}\NormalTok{ (R, }\AttributeTok{Rf =} \DecValTok{0}\NormalTok{, }\AttributeTok{p =} \FloatTok{0.95}\NormalTok{, }\AttributeTok{method =} \FunctionTok{c}\NormalTok{(}\StringTok{"StdDev"}\NormalTok{, }\StringTok{"VaR"}\NormalTok{, }\StringTok{"ES"}\NormalTok{), }
        \AttributeTok{weights =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{annualize =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{bootsd =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{geometric =} \ConstantTok{FALSE}\NormalTok{,...) }
\NormalTok{\{}
\NormalTok{    R }\OtherTok{=} \FunctionTok{checkData}\NormalTok{(R)}
    
\NormalTok{    method }\OtherTok{\textless{}{-}} \FunctionTok{match.arg}\NormalTok{(method)}
    
    \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(}\FunctionTok{dim}\NormalTok{(Rf))) }
\NormalTok{        Rf }\OtherTok{=} \FunctionTok{checkData}\NormalTok{(Rf)}
    \ControlFlowTok{if}\NormalTok{ (annualize) \{}
\NormalTok{        freq }\OtherTok{=} \FunctionTok{periodicity}\NormalTok{(R)}
        \ControlFlowTok{switch}\NormalTok{(freq}\SpecialCharTok{$}\NormalTok{scale, }\AttributeTok{minute =}\NormalTok{ \{}
                    \FunctionTok{stop}\NormalTok{(}\StringTok{"Data periodicity too high"}\NormalTok{)}
\NormalTok{                \}, }\AttributeTok{hourly =}\NormalTok{ \{}
                    \FunctionTok{stop}\NormalTok{(}\StringTok{"Data periodicity too high"}\NormalTok{)}
\NormalTok{                \}, }\AttributeTok{daily =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{252}
\NormalTok{                \}, }\AttributeTok{weekly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{52}
\NormalTok{                \}, }\AttributeTok{monthly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{12}
\NormalTok{                \}, }\AttributeTok{quarterly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{4}
\NormalTok{                \}, }\AttributeTok{yearly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{1}
\NormalTok{                \})}
\NormalTok{    \}   }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{        scale }\OtherTok{=} \DecValTok{1}
\NormalTok{    \}}
    
\NormalTok{    srm }\OtherTok{\textless{}\textless{}{-}} \ControlFlowTok{function}\NormalTok{(R, ..., Rf, p, FUNC) \{}
\NormalTok{        FUNCT }\OtherTok{\textless{}{-}} \FunctionTok{match.fun}\NormalTok{(FUNC)}
\NormalTok{        xR }\OtherTok{=} \FunctionTok{Return.excess}\NormalTok{(R, Rf)}
\NormalTok{        SRM }\OtherTok{=} \FunctionTok{mean}\NormalTok{(xR, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{/}\FunctionTok{FUNCT}\NormalTok{(}\AttributeTok{R =}\NormalTok{ R, }\AttributeTok{p =}\NormalTok{ p, }\AttributeTok{... =}\NormalTok{ ..., }
                \AttributeTok{invert =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{        SRM}
\NormalTok{    \}}
    
\NormalTok{    sra }\OtherTok{\textless{}\textless{}{-}} \ControlFlowTok{function}\NormalTok{(R, ..., Rf, p, FUNC) \{}
        \ControlFlowTok{if}\NormalTok{ (FUNC }\SpecialCharTok{==} \StringTok{"StdDev"}\NormalTok{) }
\NormalTok{            FUNC }\OtherTok{=} \StringTok{"StdDev.annualized"}
\NormalTok{        FUNCT }\OtherTok{\textless{}{-}} \FunctionTok{match.fun}\NormalTok{(FUNC)}
\NormalTok{        xR }\OtherTok{=} \FunctionTok{Return.excess}\NormalTok{(R, Rf)}
\NormalTok{        SRA }\OtherTok{=} \FunctionTok{Return.annualized}\NormalTok{(xR,}\AttributeTok{geometric=}\NormalTok{geometric,}\AttributeTok{scale=}\NormalTok{scale,}\AttributeTok{...=}\NormalTok{...)}\SpecialCharTok{/}\FunctionTok{FUNCT}\NormalTok{(}\AttributeTok{R =}\NormalTok{ R, }\AttributeTok{p =}\NormalTok{ p, }\AttributeTok{scale=}\NormalTok{scale,}\AttributeTok{... =}\NormalTok{ ..., }
                \AttributeTok{invert =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{        SRA}
\NormalTok{    \}}
    
\NormalTok{    boot.sd.fn }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(X,idx,...,Rf, p, FUNC, FUN\_ma) }\CommentTok{\# FUN\_ma: selecting srm.boot or sra}
\NormalTok{    \{}
        \FunctionTok{match.fun}\NormalTok{(FUN\_ma)(X[idx],}\AttributeTok{Rf=}\NormalTok{Rf,}\AttributeTok{FUNC=}\NormalTok{FUNC,}\AttributeTok{p=}\NormalTok{p)}
\NormalTok{    \}}
    
\NormalTok{    boot.sd }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(X, ..., Rf, p, FUNC, FUN\_ma) }
\NormalTok{    \{}
\NormalTok{        boot.res }\OtherTok{=} \FunctionTok{boot}\NormalTok{(X, }\AttributeTok{statistic=}\NormalTok{boot.sd.fn, }\AttributeTok{FUN\_ma=}\NormalTok{FUN\_ma, }\AttributeTok{Rf=}\NormalTok{Rf, }\AttributeTok{p=}\NormalTok{p, }\AttributeTok{R=}\DecValTok{10}\SpecialCharTok{*}\FunctionTok{length}\NormalTok{(X), }\AttributeTok{FUNC=}\NormalTok{FUNC)}
        \FunctionTok{sd}\NormalTok{(}\FunctionTok{as.vector}\NormalTok{(boot.res}\SpecialCharTok{$}\NormalTok{t))}
\NormalTok{    \}}
    
    
\NormalTok{    i }\OtherTok{=} \DecValTok{1}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{is.null}\NormalTok{(weights)) \{}
\NormalTok{        result }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{nrow =} \FunctionTok{length}\NormalTok{(method), }\AttributeTok{ncol =} \FunctionTok{ncol}\NormalTok{(R))}
        \FunctionTok{colnames}\NormalTok{(result) }\OtherTok{=} \FunctionTok{colnames}\NormalTok{(R)}
        \ControlFlowTok{if}\NormalTok{(bootsd)\{}
\NormalTok{            result.boot.sd }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{nrow=}\FunctionTok{length}\NormalTok{(method), }\AttributeTok{ncol=}\FunctionTok{ncol}\NormalTok{(R))}
\NormalTok{            \}}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{        result }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{nrow =} \FunctionTok{length}\NormalTok{(method))}
\NormalTok{    \}}
\NormalTok{    tmprownames }\OtherTok{=} \FunctionTok{vector}\NormalTok{()}
    
    \ControlFlowTok{if}\NormalTok{(bootsd) }\FunctionTok{require}\NormalTok{(boot)}
    
    \ControlFlowTok{for}\NormalTok{ (FUNCT }\ControlFlowTok{in}\NormalTok{ method) \{}
        \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{is.null}\NormalTok{(weights)) \{}
            \ControlFlowTok{if}\NormalTok{ (annualize) \{}
\NormalTok{                result[i, ] }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(R, }\AttributeTok{FUN =}\NormalTok{ sra, }\AttributeTok{Rf =}\NormalTok{ Rf, }\AttributeTok{p =}\NormalTok{ p, }\AttributeTok{FUNC =}\NormalTok{ FUNCT, ...)}
            \ControlFlowTok{if}\NormalTok{(bootsd)}
\NormalTok{                result.boot.sd[i,] }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(R,}\AttributeTok{FUN=}\NormalTok{boot.sd, }\AttributeTok{Rf=}\NormalTok{Rf, }\AttributeTok{p=}\NormalTok{p, }\AttributeTok{FUNC=}\NormalTok{FUNCT,}\AttributeTok{FUN\_ma=}\StringTok{"sra"}\NormalTok{,...)}
\NormalTok{        \}}
            \ControlFlowTok{else}\NormalTok{ \{result[i, ] }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(R, }\AttributeTok{FUN =}\NormalTok{ srm, }\AttributeTok{Rf =}\NormalTok{ Rf, }
                        \AttributeTok{p =}\NormalTok{ p, }\AttributeTok{FUNC =}\NormalTok{ FUNCT, ...)}
                \ControlFlowTok{if}\NormalTok{(bootsd)}
\NormalTok{                    result.boot.sd[i,] }\OtherTok{=} \FunctionTok{sapply}\NormalTok{(R,}\AttributeTok{FUN=}\NormalTok{boot.sd,}\AttributeTok{Rf=}\NormalTok{Rf, }\AttributeTok{p=}\NormalTok{p, }\AttributeTok{FUNC=}\NormalTok{FUNCT,}\AttributeTok{FUN\_ma=}\StringTok{"srm"}\NormalTok{,...)}
\NormalTok{            \}}
\NormalTok{        \}}
        \ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{            result[i, ] }\OtherTok{=} \FunctionTok{mean}\NormalTok{(R }\SpecialCharTok{\%*\%}\NormalTok{ weights, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{/}\FunctionTok{match.fun}\NormalTok{(FUNCT)(R, }
                    \AttributeTok{Rf =}\NormalTok{ Rf, }\AttributeTok{p =}\NormalTok{ p, }\AttributeTok{weights =}\NormalTok{ weights, }\AttributeTok{portfolio\_method =} \StringTok{"single"}\NormalTok{, }
                    \AttributeTok{... =}\NormalTok{ ...)}
\NormalTok{        \}}
\NormalTok{        tmprownames }\OtherTok{=} \FunctionTok{c}\NormalTok{(tmprownames, }\FunctionTok{paste}\NormalTok{(}\ControlFlowTok{if}\NormalTok{ (annualize) }\StringTok{"Annualized "}\NormalTok{, }
\NormalTok{                        FUNCT, }\StringTok{" Sharpe"}\NormalTok{, }\StringTok{" (Rf="}\NormalTok{, }\FunctionTok{round}\NormalTok{(scale }\SpecialCharTok{*} \FunctionTok{mean}\NormalTok{(Rf) }\SpecialCharTok{*} 
                                        \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{), }\StringTok{"\%, p="}\NormalTok{, }\FunctionTok{round}\NormalTok{(p }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{), }\StringTok{"\%):"}\NormalTok{, }\AttributeTok{sep =} \StringTok{""}\NormalTok{))}
\NormalTok{        i }\OtherTok{=}\NormalTok{ i }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{    \}}
    \FunctionTok{rownames}\NormalTok{(result) }\OtherTok{=}\NormalTok{ tmprownames}
    \ControlFlowTok{if}\NormalTok{(bootsd)}
        \FunctionTok{rownames}\NormalTok{(result.boot.sd)}\OtherTok{=}\NormalTok{tmprownames}
    \ControlFlowTok{if}\NormalTok{(bootsd) }
        \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{estimate =}\NormalTok{ result, }\AttributeTok{boot.sd =}\NormalTok{ result.boot.sd))}
    \FunctionTok{return}\NormalTok{(result)}
\NormalTok{\}}



\NormalTok{StdDev.annualized }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{ (R, }\AttributeTok{scale =} \ConstantTok{NA}\NormalTok{, ...) }
\NormalTok{\{}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{is.na}\NormalTok{(scale) }\SpecialCharTok{\&\&} \SpecialCharTok{!}\FunctionTok{xtsible}\NormalTok{(R)) }
        \FunctionTok{stop}\NormalTok{(}\StringTok{"\textquotesingle{}R\textquotesingle{} needs to be timeBased or xtsible, or scale must be specified."}\NormalTok{)}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{is.na}\NormalTok{(scale)) \{}
\NormalTok{        freq }\OtherTok{=} \FunctionTok{periodicity}\NormalTok{(R)}
        \ControlFlowTok{switch}\NormalTok{(freq}\SpecialCharTok{$}\NormalTok{scale, }\AttributeTok{minute =}\NormalTok{ \{}
                    \FunctionTok{stop}\NormalTok{(}\StringTok{"Data periodicity too high"}\NormalTok{)}
\NormalTok{                \}, }\AttributeTok{hourly =}\NormalTok{ \{}
                    \FunctionTok{stop}\NormalTok{(}\StringTok{"Data periodicity too high"}\NormalTok{)}
\NormalTok{                \}, }\AttributeTok{daily =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{252}
\NormalTok{                \}, }\AttributeTok{weekly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{52}
\NormalTok{                \}, }\AttributeTok{monthly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{12}
\NormalTok{                \}, }\AttributeTok{quarterly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{4}
\NormalTok{                \}, }\AttributeTok{yearly =}\NormalTok{ \{}
\NormalTok{                    scale }\OtherTok{=} \DecValTok{1}
\NormalTok{                \})}
\NormalTok{    \}}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{is.vector}\NormalTok{(R)) \{}
        \FunctionTok{sqrt}\NormalTok{(scale) }\SpecialCharTok{*} \FunctionTok{sd}\NormalTok{(R, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    \}}
    \ControlFlowTok{else}\NormalTok{ \{}
        \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{xtsible}\NormalTok{(R) }\SpecialCharTok{\&} \FunctionTok{is.na}\NormalTok{(scale)) }
            \FunctionTok{stop}\NormalTok{(}\StringTok{"\textquotesingle{}R\textquotesingle{} needs to be timeBased or xtsible, or scale must be specified."}\NormalTok{)}
\NormalTok{        R }\OtherTok{=} \FunctionTok{checkData}\NormalTok{(R)}
\NormalTok{        result }\OtherTok{=} \FunctionTok{apply}\NormalTok{(R, }\DecValTok{2}\NormalTok{, sd.multiperiod, }\AttributeTok{scale =}\NormalTok{ scale)}
        \FunctionTok{dim}\NormalTok{(result) }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{NCOL}\NormalTok{(R))}
        \FunctionTok{colnames}\NormalTok{(result) }\OtherTok{=} \FunctionTok{colnames}\NormalTok{(R)}
        \FunctionTok{rownames}\NormalTok{(result) }\OtherTok{=} \StringTok{"Annualized Standard Deviation"}
        \FunctionTok{return}\NormalTok{(result)}
\NormalTok{    \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}


\end{document}
